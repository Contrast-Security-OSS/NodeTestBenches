<h1 class="page-header">Path-Traversal</h1>
<p><a target="_blank" href="https://www.owasp.org/index.php/Path_Traversal">Path Traversal Info</a></p>
<% viewData.forEach(function(view) { %>
<div class="row" style="min-height: 200px;">
  <div class="col-xs-12 col-sm-6" style="padding-bottom: 30px;">
    <h4 class="sub-header">Path Traversal From <%= view.sink %></h4>
  <form method="GET" action="<%= view.url %>/unsafe" target="_blank">
    <div class="form-group">
      <label for="exampleInputEmail1">Path</label>
      <input name="input" class="form-control" id="exampleInputEmail1" value="../../../../../../../../../etc/passwd">
    </div>
    <button type="submit" class="btn btn-default">Submit</button>
  </form>
  </div>
</div>
<% }); %>
<style type="text/css">
 button.method.left, button.method.right {
   line-height : 12pt;
 }
 button.method.left {
   border-top-right-radius : 0;
   border-bottom-right-radius : 0;
   border-right: none;
   padding-right : .7em;
   margin-right: 0;
 }
 button.method.right {
   border-top-left-radius : 0;
   border-bottom-left-radius : 0;
   border-left: none;
   padding-left : .7em;
   margin-left: 0;
 }
 button.method.active {
   color: #333;
   background-color: #e6e6e6;
   border-color: #adadad;
 }
</style>

<script type="text/javascript">
 $(function ( ) {
   $('form')
     .attr('target', 'cmd-injection')
     .each(( idx, elem ) => {
       $(elem).find('.form-group').after(
         $('<button>')
           .text('Unsafe')
           .attr('type', 'button')
           .addClass('method left btn btn-default active')
           .on('click', ( e ) => {
             const elem = $(e.target);
             const form = elem.closest('form');
             elem.addClass('active');
             elem.siblings('.method').removeClass('active');
             const newUrl = form.attr('action').replace(/\bsafe\b/, 'unsafe');
             form.attr('action', newUrl);
           }),
         $('<button>')
           .text('Safe')
           .attr('type', 'button')
           .addClass('method right btn btn-default')
           .on('click', ( e ) => {
             const elem = $(e.target);
             const form = elem.closest('form');
             elem.addClass('active');
             elem.siblings('.method').removeClass('active');
             const newUrl = form.attr('action').replace(/\bunsafe\b/, 'safe');
             form.attr('action', newUrl);
           }));
     });
 });
</script>

